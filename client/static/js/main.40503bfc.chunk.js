(this["webpackJsonpsync-react"]=this["webpackJsonpsync-react"]||[]).push([[0],{43:function(e,t,n){},44:function(e,t,n){},46:function(e,t,n){},48:function(e,t,n){},49:function(e,t,n){},81:function(e,t,n){},82:function(e,t,n){"use strict";n.r(t);var a,r=n(1),c=n.n(r),o=n(37),s=n.n(o),i=(n(43),n(2)),u=(n(44),n(9)),l=n.n(u),d=n(16),m=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new URL("".concat("https://www.googleapis.com/youtube/v3","/search"))).searchParams.append("part","snippet"),n.searchParams.append("key","AIzaSyBdDu4JyGXerDKJgBS2LrBLuxDUXTY6nbo"),n.searchParams.append("type","video"),n.searchParams.append("maxResults",8),n.searchParams.append("q",t),e.next=8,fetch(n.href);case 8:return a=e.sent,e.next=11,a.json();case 11:return r=e.sent,e.abrupt("return",r.items);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var j=function(e,t,n){clearTimeout(a),a=setTimeout((function(){return e(n)}),t)},f=(n(46),n(0));var b=function(e){var t=e.setVideoId,n=Object(r.useState)([]),a=Object(i.a)(n,2),c=a[0],o=a[1],s=Object(r.useState)(""),u=Object(i.a)(s,2),b=u[0],h=u[1],p=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.target.value.length){e.next=2;break}return e.abrupt("return",o([]));case 2:return e.next=4,m(t.target.value);case 4:n=e.sent,a=n.map((function(e){return{id:e.id.videoId,title:e.snippet.title,channelTitle:e.snippet.channelTitle,videoImage:e.snippet.thumbnails.high}})),o(a);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=function(e){t(e.target.id),h("")};return Object(f.jsxs)("div",{className:"search-bar-container",children:[Object(f.jsx)("input",{id:"search-bar",className:"search-bar",onChange:function(e){j(p,500,e),h(e.target.value)},placeholder:"Search video...",type:"search",value:b}),Object(f.jsx)("ul",{children:b?c.map((function(e){return Object(f.jsxs)("li",{className:"video",children:[Object(f.jsx)("img",{src:e.videoImage.url,alt:"",className:"video-image"}),Object(f.jsxs)("div",{className:"video-info-container",children:[Object(f.jsx)("h3",{children:e.title}),Object(f.jsx)("p",{children:e.channelTitle})]}),Object(f.jsx)("buttom",{className:"video-button",children:Object(f.jsx)("i",{id:e.id,onClick:O,class:"fas fa-play"})})]},e.id)})):null})]})},h=[];window.onYouTubeIframeAPIReady=function(){h.forEach((function(e){e(!0)}))};n(48);var p=0,O=!1;var v=function(e){var t=e.videoId,n=e.socket,a=e.roomId,c=e.joinSync,o=e.setVideoId,s=Object(r.useRef)(p).current,u=Object(r.useRef)(null),l=Object(r.useState)(O),d=Object(i.a)(l,2),m=d[0],j=d[1],b="player-".concat(s),v=Object(r.useRef)({shouldMatch:null,localPlayer:!0}),x=Object(r.useRef)(!0),y=Object(r.useRef)(t);function g(e){switch(e){case"play":v.current={localPlayer:!1,shouldMatch:1};break;case"stop":v.current={localPlayer:!1,shouldMatch:2};break;case"loadVideo":x.current=!1}}return Object(r.useEffect)((function(){return p+=1}),[]),Object(r.useEffect)((function(){var e=function(e){j(e),O=e};return function(e){h.push(e)}(e),function(){return t=e,void(h=h.filter((function(e){return e!==t})));var t}}),[]),Object(r.useEffect)((function(){if(!m){var e=document.createElement("script");e.src="https://www.youtube.com/iframe_api",document.body.append(e)}}),[m]),Object(r.useEffect)((function(){m&&(u.current=new window.YT.Player(b,{setVideoId:o,height:500,width:889,videoId:t,playerVars:{playsinline:1}}))}),[m,b]),Object(r.useEffect)((function(){if(m)return u.current.addEventListener("onStateChange",e),function(){u.current.removeEventListener("onStateChange",e)};function e(e){if(a&&n){if(v.current.localPlayer)switch(e.data){case 1:n.emit("serverEventsHandler",{type:"playerEvent",event:"PLAY",roomId:a,currentData:{time:u.current.playerInfo.currentTime}});break;case 2:n.emit("serverEventsHandler",{type:"playerEvent",event:"PAUSE",roomId:a})}v.current.shouldMatch===e.data&&(v.current={shouldMatch:null,localPlayer:!0})}}}),[m,a,n]),Object(r.useEffect)((function(){u.current&&t&&(g("play"),u.current.loadVideoById(t),y.current=t,a&&x.current?n.emit("serverEventsHandler",{type:"loadVideo",roomId:a,currentData:{newVideoId:t}}):x.current=!0)}),[t,n]),Object(r.useEffect)((function(){if(n&&a)return n.emit("roomHandler",{roomId:a,joinSync:c}),n.on("serverEventsHandler",(function(e){var a=e.type,r=e.event,c=e.currentData;switch(a){case"playerEvent":"PLAY"===r?(g("play"),u.current.seekTo(Math.round(c.time+.5),!0),setTimeout((function(){u.current.playVideo()}),250)):"PAUSE"===r&&(g("stop"),u.current.pauseVideo());break;case"loadVideo":g("loadVideo"),o(c.newVideoId);break;case"joinAskData":n.emit("serverEventsHandler",{type:"sendJoinedData",currentData:{newVideoId:y.current,newSocketId:c.newSocketId,time:u.current.playerInfo.currentTime,state:u.current.getPlayerState()}});break;case"recieveCurrentData":c.newVideoId!==t&&(g("loadVideo"),o(c.newVideoId)),setTimeout((function(){1===c.state||3===c.state?(g("play"),u.current.seekTo(Math.round(c.time+1),!0)):(g("play"),u.current.seekTo(Math.round(c.time+1),!0),setTimeout((function(){g("stop"),u.current.pauseVideo()}),500))}),2e3)}})),function(){return n.off("roomHandler")}}),[c,a,o,n,t]),Object(f.jsx)("div",{className:"video-container",children:Object(f.jsx)("div",{className:"video-display",id:b})})};n(49);var x=function(e){var t=e.roomId,n=e.setRoomId,a=e.setJoinSync,r=c.a.useState(""),o=Object(i.a)(r,2),s=o[0],u=o[1];return Object(f.jsx)("div",{className:"nav-container",children:t?Object(f.jsxs)("div",{className:"room-info-container",children:[Object(f.jsxs)("p",{className:"room-info",children:[" Your room ID: ",t]}),Object(f.jsx)("button",{onClick:function(){window.location.reload()},className:"create-room-button",children:"LEAVE ROOM"})]}):Object(f.jsxs)("div",{className:"room-info-container",children:[Object(f.jsx)("button",{className:"create-room-button",onClick:function(e){var t=Math.floor(1e3+9e3*Math.random()).toString();n(t)},children:"CREATE ROOM"}),Object(f.jsxs)("form",{className:"join-container",onSubmit:function(e){e.preventDefault(),4===s.length&&(a(!0),n(s),u(""))},children:[Object(f.jsx)("input",{className:"join-room-input",placeholder:" Enter room ID",value:s,onChange:function(e){return u(e.target.value)}}),Object(f.jsx)("button",{className:"join-room-button",children:"JOIN ROOM"})]})]})})},y=n(38),g=n(21);n(81);var I=function(e){var t=e.roomId,n=e.socket,a=(e.pepe,Object(r.useState)(null)),c=Object(i.a)(a,2),o=c[0],s=c[1],u=Object(r.useState)(""),l=Object(i.a)(u,2),d=l[0],m=l[1],j=Object(r.useState)([]),b=Object(i.a)(j,2),h=b[0],p=b[1],O=Object(r.useState)(""),v=Object(i.a)(O,2),x=v[0],y=v[1],I=Object(r.useState)(!0),N=Object(i.a)(I,2),S=N[0],w=N[1];return Object(r.useEffect)((function(){if(n&&t)return n.on("chatHandler",(function(e){var t=e.newMessage,n=e.userName;p([].concat(Object(g.a)(h),[{message:t,name:n,textColor:"rgb(80, 80, 180)"}]))})),function(){return n.off("chatHandler")}}),[n,t,h]),Object(r.useEffect)((function(){if(!localStorage.getItem("userName"))return s("New Astronaut");s(localStorage.getItem("userName"))}),[]),Object(f.jsxs)("div",{className:"room-chat-container",children:[Object(f.jsx)("form",{onSubmit:function(e){if(e.preventDefault(),!x)return w(!0);x.length>22||(localStorage.removeItem("userName"),localStorage.setItem("userName",x),s(x),y(""),w(!0))},children:S?Object(f.jsx)("button",{className:"name-btn",onClick:function(){return w(!1)},children:"Change name"}):Object(f.jsx)("input",{className:"input",type:"text",placeholder:"Change name.. (max 20 characters)",onChange:function(e){return y(e.target.value)},value:x})}),Object(f.jsx)("div",{className:"chat-container",children:Object(f.jsx)("ul",{className:"chat-messages-container",children:h.map((function(e){return Object(f.jsxs)("li",{className:"message-li",children:[Object(f.jsx)("p",{className:"chat-name",style:{color:e.textColor},children:e.name}),Object(f.jsx)("div",{className:"message-text",children:e.message})]})}))})}),Object(f.jsx)("form",{onSubmit:function(e){e.preventDefault(),p([].concat(Object(g.a)(h),[{message:d,name:o,textColor:"rgb(180, 80, 80)"}])),n.emit("chatHandler",{newMessage:d,userName:o,roomId:t}),m("")},children:Object(f.jsx)("input",{type:"text",className:"input",placeholder:"Send message..",onChange:function(e){return m(e.target.value)},value:d})})]})};var N=function(){var e=Object(r.useState)("uD4izuDMUQA"),t=Object(i.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(null),o=Object(i.a)(c,2),s=o[0],u=o[1],l=Object(r.useState)(!1),d=Object(i.a)(l,2),m=d[0],j=d[1],h=Object(r.useState)(null),p=Object(i.a)(h,2),O=p[0],g=p[1];return Object(r.useEffect)((function(){var e=y.io.connect("https://sync-yt-video.herokuapp.com/",{transports:["websocket"]});g(e)}),[]),Object(f.jsxs)("div",{className:"app-container",children:[Object(f.jsx)(b,{setVideoId:a}),Object(f.jsxs)("main",{className:"main-container",children:[Object(f.jsx)(x,{roomId:s,setRoomId:u,setJoinSync:j}),Object(f.jsxs)("div",{className:"deep-main-container",children:[Object(f.jsx)(v,{setVideoId:a,videoId:n,socket:O,roomId:s,joinSync:m}),O?Object(f.jsx)(I,{socket:O,roomId:s}):null]})]})]})};s.a.render(Object(f.jsx)(N,{}),document.getElementById("root"))}},[[82,1,2]]]);
//# sourceMappingURL=main.40503bfc.chunk.js.map